<h1 id="CSP2020-信心赛"><a href="#CSP2020-信心赛" class="headerlink" title="CSP2020 信心赛"></a><center>CSP2020 信心赛</center></h1><center>出题学校：大连24中</center>

<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">题目名称</th>
<th style="text-align:center">树上的数</th>
<th style="text-align:center">时代的眼泪</th>
<th style="text-align:center">传统艺能</th>
<th style="text-align:center">铺设道路</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">题目类型</td>
<td style="text-align:center">传统型</td>
<td style="text-align:center">传统型</td>
<td style="text-align:center">传统型</td>
<td style="text-align:center">传统型</td>
</tr>
<tr>
<td style="text-align:center">试题名称</td>
<td style="text-align:center">tree</td>
<td style="text-align:center">tears</td>
<td style="text-align:center">string</td>
<td style="text-align:center">road</td>
</tr>
<tr>
<td style="text-align:center">提交程序名</td>
<td style="text-align:center">tree.cpp</td>
<td style="text-align:center">tears.cpp</td>
<td style="text-align:center">string.cpp</td>
<td style="text-align:center">road.cpp</td>
</tr>
<tr>
<td style="text-align:center">输入文件名</td>
<td style="text-align:center">tree.in</td>
<td style="text-align:center">tears.in</td>
<td style="text-align:center">string.in</td>
<td style="text-align:center">road.in</td>
</tr>
<tr>
<td style="text-align:center">输出文件名</td>
<td style="text-align:center">tree.out</td>
<td style="text-align:center">tears.out</td>
<td style="text-align:center">string.out</td>
<td style="text-align:center">road.out</td>
</tr>
<tr>
<td style="text-align:center">每个测试点时限</td>
<td style="text-align:center">2.0s</td>
<td style="text-align:center">2.0s</td>
<td style="text-align:center">1.0s</td>
<td style="text-align:center">1.0s</td>
</tr>
<tr>
<td style="text-align:center">空间限制</td>
<td style="text-align:center">512MB</td>
<td style="text-align:center">512MB</td>
<td style="text-align:center">512MB</td>
<td style="text-align:center">512MB</td>
</tr>
<tr>
<td style="text-align:center">是否有Special Judge</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
</div>
<p>注意事项</p>
<ol>
<li><strong>提交文件请对每道题目分别<font color=red>建立子文件夹</font>，仅支持C++语言，编译命令为-O2 -std=c++11</strong>。</li>
<li>程序可使用的栈空间大小与该题内存空间限制一致。</li>
<li>文件名必须使用英文小写。</li>
<li>每题的时间限制均至少为标准程序在与评测相同的环境下最慢运行时间的$2$倍。</li>
<li>题目难度和顺序无直接关系。</li>
<li>比赛时间为$4$小时。</li>
<li>由于出题人水平很低且是第一次尝试出题，题目质量可能较低，欢迎大家来D出题人。</li>
<li>如果出现数据出锅/标程不为最优解等问题，也欢迎大家来D出题人，QQ：352912432。</li>
<li>最终评测配置为：Intel(R) Core(TM) i5-7400T CPU @ 2.40GHz，内存 8GB​。</li>
<li>评测系统为 Ubuntu 18.04.5 LTS，编译器版本为 G++ 7.5.0。</li>
</ol>
<div STYLE="page-break-after: always;"></div>

<h2 id="树上的数-tree"><a href="#树上的数-tree" class="headerlink" title="树上的数(tree)"></a><center>树上的数(tree)</center></h2><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><p>给你一棵有$n$个节点的以$1$号节点为根的有根树，节点有点权，初始全部为$1$。</p>
<p>接下来有$m$个操作，第$i$次操作将以一个节点$u_i$为根节点的子树内的所有节点的权值设为$0$，每次操作后询问整棵树的点权和。</p>
<h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h4><p>第一行两个数$n,m$。</p>
<p>第二行两个不超过$10^9$的正整数$a,b$。</p>
<p>为减少输入量，读入方式如下：</p>
<p>$f_2=1$</p>
<p>$f<em>i=((f</em>{i−1}∗a+b)\  xor \  19760817) \mod (i−1)+1$</p>
<p>即<code>fa[i] = ((1ll * fa[i - 1] * a + b) ^ 19760817) % (i - 1) + 1;</code></p>
<p>其中$f_i$为$i$节点的父节点。</p>
<p>第三行三个正整数$q_1,x,y$ 满足$q_1 \leq n\ \ x,y \leq 10^9$。</p>
<p>$q<em>i=(((q</em>{i-1}*x+y)\ xor \ 19760817)\ xor \ (i&lt;&lt;1)) \mod (n-1) + 2$</p>
<p>即<code>q[i] = (((1ll * q[i - 1] * x + y) ^ 19760817) ^ (i &lt;&lt; 1)) % (n - 1) + 2;</code></p>
<p>其中$q_i$表示第$i$次操作选取的节点$u_i$。</p>
<h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h4><p>为了减小输出量，你只需要将每次询问的结果异或起来输出一个数即可。</p>
<h4 id="样例一输入"><a href="#样例一输入" class="headerlink" title="样例一输入"></a>样例一输入</h4><pre><code>2 1
1 1
2 1 1
</code></pre><h4 id="样例一输出"><a href="#样例一输出" class="headerlink" title="样例一输出"></a>样例一输出</h4><pre><code>1
</code></pre><h4 id="样例二输入"><a href="#样例二输入" class="headerlink" title="样例二输入"></a>样例二输入</h4><pre><code>20 30
47 58
5 55 88
</code></pre><h4 id="样例二输出"><a href="#样例二输出" class="headerlink" title="样例二输出"></a>样例二输出</h4><pre><code>21
</code></pre><h4 id="数据范围与约定"><a href="#数据范围与约定" class="headerlink" title="数据范围与约定"></a>数据范围与约定</h4><p>本题采用子任务捆绑测试。对于每个子任务，你只有通过了这个子任务的所有数据，才能获得这个子任务的分数。</p>
<ul>
<li>子任务$1$（$20$分）：$n,m \leq 2000$</li>
<li>子任务$2$（$40$分）：$n,m\leq 100000$</li>
<li>子任务$3$（$40$分）：$n,m\leq 5000000 $</li>
</ul>
<div STYLE="page-break-after: always;"></div>

<h2 id="时代的眼泪-tears"><a href="#时代的眼泪-tears" class="headerlink" title="时代的眼泪(tears)"></a><center>时代的眼泪(tears)</center></h2><h4 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h4><p>Z 国有 $n$ 座城市，$n-1$条双向道路，每条双向道路连接两座城市，且任意<br>两座城市都能通过若干条道路相互到达，其中一个城市是该国的都城。</p>
<p>每一个城市（包括都城）都有足够多的“时代的眼泪”，且城市$u$内的”时代的<br>眼泪”的稀有度为$w_u。$</p>
<p>每一个不是都城的城市都会派出一个使者向都城进贡，对于使者在途中经过的每一个城市（包括都城），如果该城市的“时代的眼泪”的稀有度严格大于使者出发的城市的“时代的眼泪”的稀有度，则使者会取下该城市的一个“时代的眼泪”献给都城。</p>
<p>现在多次询问，每次询问都城设在某个城市时，总共会向都城进贡多少”时代的眼泪”。</p>
<p>形式化的讲，给定一棵树，每次询问一个点$u$，需要你回答：</p>
<script type="math/tex; mode=display">\sum_{v \neq u} \sum_{x\ on\ path(u,v)}[w_x>w_v]</script><h4 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h4><p>第一行两个整数$n,Q$。</p>
<p>第二行$n$个整数，第$i$个正整数为$w_i$，即城市$i$“时代的眼泪”的稀有度。</p>
<p>接下来$n-1$行，每行两个整数$x,y$，表示连接城市$x$与城市$y$的一条道路。</p>
<p>接下来$Q$行，每行一个整数$u$，询问都城为$u$时的答案。</p>
<h4 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h4><p>输出$Q$行，每行一个整数表示答案。</p>
<h4 id="样例一输入-1"><a href="#样例一输入-1" class="headerlink" title="样例一输入"></a>样例一输入</h4><pre><code>10 10
3 5 10 9 8 8 2 4 3 3
1 2
3 4
2 4
4 5
7 10
2 7
7 9
10 8
6 8
1
2
3
4
5
6
7
8
9
10
</code></pre><h4 id="样例一输出-1"><a href="#样例一输出-1" class="headerlink" title="样例一输出"></a>样例一输出</h4><pre><code>6
6
22
13
18
13
2
7
3
3
</code></pre><h4 id="样例二"><a href="#样例二" class="headerlink" title="样例二"></a>样例二</h4><p>见下发文件中的<code>tears/tears2.in</code>和<code>tears/tears2.out</code></p>
<h4 id="数据范围与约定-1"><a href="#数据范围与约定-1" class="headerlink" title="数据范围与约定"></a>数据范围与约定</h4><p>对于所有测试点，满足$n,Q\leq 10^6$,$1\leq w_i \leq 10^9$。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">测试点编号</th>
<th style="text-align:center">$n,Q$</th>
<th style="text-align:center">$w_i$</th>
<th style="text-align:center">其他约束</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$1 \sim 2$</td>
<td style="text-align:center">$\leq 200$</td>
<td style="text-align:center">$\leq n$</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">$3 \sim 5$</td>
<td style="text-align:center">$\leq 2000$</td>
<td style="text-align:center">$\leq n$</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">$6 \sim 9$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">$\leq n$</td>
<td style="text-align:center">第$i$条边连接$1$和$i+1$</td>
</tr>
<tr>
<td style="text-align:center">$10 \sim 13$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">$\leq n$</td>
<td style="text-align:center">第$i$条边连接$i$和$i+1$</td>
</tr>
<tr>
<td style="text-align:center">$14 \sim 16$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">$\leq n$</td>
<td style="text-align:center">$Q=1$且询问点是$1$</td>
</tr>
<tr>
<td style="text-align:center">$17 \sim 18$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">$\leq n$</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">$19 \sim 20$</td>
<td style="text-align:center">$\leq 10^6$</td>
<td style="text-align:center">$\leq 10^9$</td>
<td style="text-align:center">无</td>
</tr>
</tbody>
</table>
</div>
<div STYLE="page-break-after: always;"></div>

<h2 id="传统艺能-string"><a href="#传统艺能-string" class="headerlink" title="传统艺能(string)"></a><center>传统艺能(string)</center></h2><h4 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h4><p>给定一个由’A’,’B’,’C’三种字母组成的字符串，你需要支持两种操作：</p>
<p><code>1 p c</code>：将位置$p$上的字符改为$c$，其中$c$为’A’,’B’,’C’其中之一，有可能该位置的字符没有变化。</p>
<p><code>2 l r</code>：求出区间$[l,r]$构成的子串的本质不同子序列个数（不含空子序列）。</p>
<p>串 $s$ 是串 $t$ 的子序列当且仅当串 $s$ 可以通过删去 $t$ 中的某些字符得到。</p>
<p>两个子序列本质不同当且仅当它们长度不同或存在一个位置使得该位置上两个子序列的字符不同。</p>
<h4 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h4><p>第一行两个整数 $n,m$，表示字符串长度与操作个数。</p>
<p>第二行为该字符串。</p>
<p>接下来$m$行，第一个整数为操作的编号，以题目描述为准。</p>
<h4 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h4><p>对于每个询问，输出一行对应的答案，<strong>对$998244353$取模</strong>。</p>
<h4 id="样例一输入-2"><a href="#样例一输入-2" class="headerlink" title="样例一输入"></a>样例一输入</h4><pre><code>10 5
ABCCBAABCC
2 3 7
1 4 C
1 5 C
2 1 9
2 1 10
</code></pre><h4 id="样例一输出-2"><a href="#样例一输出-2" class="headerlink" title="样例一输出"></a>样例一输出</h4><pre><code>17
167
245
</code></pre><h4 id="样例二-1"><a href="#样例二-1" class="headerlink" title="样例二"></a>样例二</h4><p>见下发文件中的<code>string/string2.in</code>和<code>string/string2.out</code></p>
<h4 id="数据范围与约定-2"><a href="#数据范围与约定-2" class="headerlink" title="数据范围与约定"></a>数据范围与约定</h4><p>对于所有测试点，满足$n,m\leq 10^5$。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">测试点编号</th>
<th style="text-align:center">$n,m$</th>
<th style="text-align:center">其他约束</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$\leq 1$</td>
<td style="text-align:center">$l=1$,$r=n$</td>
</tr>
<tr>
<td style="text-align:center">$2$</td>
<td style="text-align:center">$\leq 5$</td>
<td style="text-align:center">$l=1$,$r=n$</td>
</tr>
<tr>
<td style="text-align:center">$3 \sim 4$</td>
<td style="text-align:center">$\leq 20$</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">$5 \sim 6$</td>
<td style="text-align:center">$\leq 2000$</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">$7$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">保证任意时刻字符串中只有字符’A’</td>
</tr>
<tr>
<td style="text-align:center">$8 \sim 12$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">$l=1$,$r=n$,且保证任意时刻字符串中只有字符’A’和’B’</td>
</tr>
<tr>
<td style="text-align:center">$13 \sim 15$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">没有操作1</td>
</tr>
<tr>
<td style="text-align:center">$16 \sim 18$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">$l=1$,$r=n$</td>
</tr>
<tr>
<td style="text-align:center">$19 \sim 20$</td>
<td style="text-align:center">$\leq 10^5$</td>
<td style="text-align:center">无</td>
</tr>
</tbody>
</table>
</div>
<div STYLE="page-break-after: always;"></div>

<h2 id="铺设道路-road"><a href="#铺设道路-road" class="headerlink" title="铺设道路(road)"></a><center>铺设道路(road)</center></h2><h4 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h4><p>春春是一名道路工程师，负责铺设一条长度为 $n$ 的道路。</p>
<p>铺设道路的主要工作是填平下陷的地表。整段道路可以看作是 $n$ 块首尾相连的区域，一开始，第 $i$ 块区域下陷的深度为 $d_i$ 。</p>
<p>春春每天可以选择一段连续区间$[L,R]$ ，填充这段区间中的每块区域，让其下陷深度减少 $1$。在选择区间时，需要保证，区间内的每块区域在填充前下陷深度均不为 $0$ 。</p>
<p>春春希望你能帮他设计一种方案，可以在最短的时间内将整段道路的下陷深度都变为 $0$ 。</p>
<p>但是每次操作消耗的体力值不一定相同,对于一次操作$[L,R]$,春春会消耗$(R-L+1)^2$的体力值。</p>
<p>现在春春想要知道在保证<strong>时间最短</strong>的前提下,她能消耗的体力值的最大值和最小值。</p>
<h4 id="输入格式-3"><a href="#输入格式-3" class="headerlink" title="输入格式"></a>输入格式</h4><p>输入文件包含两行，第一行包含一个整数 $n$，表示道路的长度。 第二行包含 $n$ 个整数，相邻两数间用一个空格隔开，第 $i$ 个整数为 $d_i$ 。</p>
<h4 id="输出格式-3"><a href="#输出格式-3" class="headerlink" title="输出格式"></a>输出格式</h4><p>输出三行,分别为最少需要多少天完成任务,以及在保证<strong>时间最短</strong>的前提下消耗体力值的最大值和最小值。</p>
<p>其中<strong>消耗体力值的最大值和最小值要对$10^9+7$取模</strong>。</p>
<h4 id="样例一输入-3"><a href="#样例一输入-3" class="headerlink" title="样例一输入"></a>样例一输入</h4><pre><code>6   
4 3 2 5 3 5
</code></pre><h4 id="样例一输出-3"><a href="#样例一输出-3" class="headerlink" title="样例一输出"></a>样例一输出</h4><pre><code>9
90
66
</code></pre><h4 id="样例二-2"><a href="#样例二-2" class="headerlink" title="样例二"></a>样例二</h4><p>见下发文件中的<code>road/road2.in</code>和<code>road/road2.out</code></p>
<h4 id="数据范围与约定-3"><a href="#数据范围与约定-3" class="headerlink" title="数据范围与约定"></a>数据范围与约定</h4><p>本题采用子任务捆绑测试。对于每个子任务，你只有通过了这个子任务的所有数据，才能获得这个子任务的分数。</p>
<p>对于全部的数据 满足$n \leq 3*10^5$,$0\leq d_i \leq 10^9$。</p>
<ul>
<li>子任务$1$（$20$分）：$n\leq 10$</li>
<li>子任务$2$（$20$分）：$n\leq 1000$</li>
<li>子任务$3$（$10$分）：$d_i$全部相等</li>
<li>子任务4（$20$分）：$\forall i\in (1,n] \ d<em>i \geq d</em>{i-1}$</li>
<li>子任务5（30分）：没有额外的限制</li>
</ul>
